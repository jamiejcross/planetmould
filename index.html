<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>News - Planet Mould</title>
  <link rel="stylesheet" href="css/styles.css" />
  <style>
    /* Responsive Metadata Styling */
    .news-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 12px;
      font-size: 0.85rem;
      line-height: 1.4;
      color: #666;
    }
    .news-meta strong {
      font-weight: 700;
      color: #333;
    }
    /* Simple AI Badge Styling */
    .ai-badge {
      display: inline-block;
      background: #fff;
      border: 1px solid #000;
      color: #000;
      padding: 2px 10px;
      font-size: 10px;
      font-weight: 800;
      border-radius: 0px;
      letter-spacing: 1px;
      text-transform: uppercase;
      margin: 10px 0;
    }
  </style>
</head>
<body>
<div class="banner">
  <a href="https://planetmould.com" class="brand">Planet Mould</a>
  <input type="checkbox" class="nav-toggle" id="navToggle" />
  <label for="navToggle" class="hamburger">☰</label>
  <div class="links">
    <a href="https://planetmould.com">Home</a>
    <a href="https://news.planetmould.com/">Mouldwire</a>
    <a href="https://planetmould.com/publications.html">Publications</a>
    <a href="https://planetmould.com/collaborations.html">Collaborations</a>
  </div>
</div>

  <div class="page-header">
    <h1>Mouldwire</h1>
    <p>Mouldwire is a bespoke science and media news service designed to collect and summarise the latest mould related research stories. This version is optimised for social science, arts and humanities researchers interested in planetary health, infrastructure, or human/non-human sociality.</p>
    <p>Mouldwire scans ~50 international peer reviewed scientific journals; public health agencies, environmental bodies, and standards organisations, news organisations; and social media platforms.</p>

    <p class="repo-callout">
    Mouldwire is an open source project. You can follow the development, 
    view the anthropological summaries in raw format, or contribute to the 
    code on Github. 
    <p><a href="https://github.com/jamiejcross/planetmould" target="_blank" class="github-link-inline"></p>
        <svg height="16" width="16" viewBox="0 0 16 16" style="fill: currentColor; vertical-align: middle; margin-bottom: 2px;">
            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
        </svg>
        GitHub Repository
    </a>.
</p>

    
    
  </div>

  <div class="controls">
    <div class="filter-row">
      <div class="filter-buttons">
        <button class="filter-btn active" data-filter="all">Show All</button>
        <button class="filter-btn" data-filter="science">Microbiology</button>
        <button class="filter-btn" data-filter="health">Health & Environment</button>
        <button class="filter-btn" data-filter="indoor">Housing & Indoor Air</button>
        <button class="filter-btn" data-filter="media">Media</button>
        <button class="filter-btn active" data-filter="all">Show All</button>
     <-- </div>
      <button id="refreshBtn" class="refresh-btn">Refresh Feed</button>
    </div> -->  

    <div class="search-container">
      <input type="text" id="newsSearch" placeholder="Search (e.g. 'Infrastructure', 'Materiality', 'Tsing')..." />
    </div>
  </div>


  <div id="newsContainer">
    <div class="loading">
      <div class="spinner"></div>
      <p>Scanning the biosphere...</p>
    </div>
  </div>

  <div id="loadMoreContainer" style="text-align: center; margin: 40px 0; display: none;">
      <button id="loadMoreBtn" class="refresh-btn">Load More Results</button>
  </div>

<div class="system-logs">
    <h4>Mouldwire System Log</h4>
    <ul class="log-list">
        <li>
            <span class="log-date">2026-02-09</span>
            <span class="log-event">Inference Engine upgraded to <strong>Llama-3.3-70B</strong></span>
        </li>
        <li>
            <span class="log-date">2026-02-07</span>
            <span class="log-event">Calibration: "Patchy Anthropocene" field guide logic implemented.</span>
        </li>
        <li>
            <span class="log-date">2026-02-01</span>
            <span class="log-event">Mouldwire v0.3 active: 50+ journals integrated.</span>
        </li>
    </ul>
</div>
  
  <div class="footer-banner">
    <div class="footer-left">
      <div class="footer-credit">
        <p>Planet Mould is supported by the University of Glasgow.</p>
        <p>Website, Photographs + Design: delacroix@edinburghpress.com</p>
      </div>
      <a href="mailto:jamie.cross@glasgow.ac.uk" class="email">jamie.cross@glasgow.ac.uk</a>
    </div>
    <img src="glasgow logo.png" alt="University of Glasgow" class="uni-logo" />
  </div>

<script>
  let allNews = []; 
  let currentFilter = "all";
  let visibleCount = 10; // Increased to 20 for better initial load

  const categoryMap = {
    'Microbiology': 'science',
    'Social Media': 'media',
    'Health & Environment': 'health',
    'Housing & Indoor Air': 'indoor',
    'Clinical': 'science'
  };

  const theoryKeywords = ['anthropology', 'sociology', 'ethnography', 'material culture', 'political economy', 'infrastructure', 'sociality', 'biopolitics'];

  async function fetchNews() {
    const container = document.getElementById("newsContainer");
    try {
      let response = await fetch('articles_enhanced.json?v=' + new Date().getTime());
      if (!response.ok) response = await fetch('mould_news.json?v=' + new Date().getTime());
      allNews = await response.json(); 
      displayNews();
    } catch (error) {
      container.innerHTML = `<p class="error-state" style="padding:40px; text-align:center;">The biosphere archive is currently updating.</p>`;
    }
  }

  function displayNews() {
    const container = document.getElementById("newsContainer");
    const loadMoreContainer = document.getElementById("loadMoreContainer");
    if (!container) return;

    let filtered = allNews;

    // Filter logic
    if (currentFilter !== 'all') {
      filtered = allNews.filter(item => {
        const text = (item.title + " " + (item.summary || "")).toLowerCase();
        const isTheory = theoryKeywords.some(k => text.includes(k));
        if (currentFilter === 'theory') return isTheory;
        const aiMappedCat = categoryMap[item.primary_category];
        return item.category === currentFilter || aiMappedCat === currentFilter;
      });
    }

    // Search logic
    const searchTerm = document.getElementById("newsSearch")?.value.toLowerCase();
    if (searchTerm) {
      filtered = filtered.filter(item => 
        item.title.toLowerCase().includes(searchTerm) || 
        (item.summary && item.summary.toLowerCase().includes(searchTerm))
      );
    }

    if (filtered.length > 0) {
      let html = `<div class="news-list">`;
      filtered.slice(0, visibleCount).forEach((item) => {
        const isEnhanced = item.enhanced === true;
        const displayDate = item.pubDate ? new Date(item.pubDate).toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' }) : 'Recent';
        let rawSummary = item.summary || item.excerpt || "";
        let formattedSummary = rawSummary.length > 0 ? rawSummary : "No summary available for this wire.";

        html += `
          <div class="news-item">
            <div class="news-meta">
              <span><strong>Published:</strong> ${displayDate}</span>
              <span><strong>Source:</strong> ${item.source}</span>
            </div>
            <h3 class="news-title"><a href="${item.url}" target="_blank">${item.title}</a></h3>
            <div class="news-keywords">
              ${(item.keywords || []).slice(0, 3).map(k => `<span class="keyword-tag">${k}</span>`).join('')}
            </div>
            ${isEnhanced ? '<span class="ai-badge">✨ What does this mean for Planet Mould?</span>' : ''}
            <p class="news-excerpt">${formattedSummary}</p>
            <div class="source-link-container">
              <a href="${item.url}" target="_blank" class="read-more">View source online →</a>
            </div>
          </div>`;
      });
      html += `</div>`;
      container.innerHTML = html;

      // LOAD MORE LOGIC
      if (loadMoreContainer) {
          loadMoreContainer.style.display = (filtered.length > visibleCount) ? "block" : "none";
      }

    } else {
      container.innerHTML = `<p style="padding:40px; text-align:center;">No matching mould wires found.</p>`;
      if (loadMoreContainer) loadMoreContainer.style.display = "none";
    }
  }

  window.onload = () => {
    fetchNews();
    document.getElementById("newsSearch")?.addEventListener("input", () => { visibleCount = 20; displayNews(); });
    document.getElementById("refreshBtn")?.addEventListener("click", () => { visibleCount = 20; fetchNews(); });
    document.getElementById("loadMoreBtn")?.addEventListener("click", () => { visibleCount += 20; displayNews(); });
    document.querySelectorAll(".filter-btn").forEach(btn => {
      btn.addEventListener("click", (e) => {
        document.querySelectorAll(".filter-btn").forEach(b => b.classList.remove("active"));
        e.target.classList.add("active");
        currentFilter = e.target.dataset.filter;
        visibleCount = 20; 
        displayNews();
      });
    });
  };
</script>
</body>
</html>
